based on https://gist.github.com/yorickdowne/3cecc7b424ce241b173510e36754af47
